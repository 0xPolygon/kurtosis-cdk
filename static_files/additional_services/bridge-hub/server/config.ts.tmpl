import { katana, mainnet, sepolia } from 'wagmi/chains';
import type { Chain } from 'wagmi/chains';
import { ICONS } from '@/app/constants/icons';
import { createChainEntry, toNonEmptyChainArray, toProofApiUrl } from '@/app/utils/config';
import type { AppMode, AppModeConfig } from '@/app/types/appMode';
import type { ChainEntry } from '@/app/types/config';

export const customRpcUrls = {
  // Example:
  // 'eip155:1234': [{ url: 'https://rpc.example.org' }],
};

const forknetWagmi: Chain = {
  id: 8338,
  name: 'Forknet',
  rpcUrls: {
    default: { http: ['https://rpc-forknet.t.conduit.xyz'] },
  },
  blockExplorers: {
    default: { name: 'Forkscan', url: 'https://forkscan.org/' },
  },
  nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 },
};

const bokutoWagmi: Chain = {
  id: 737373,
  name: 'Bokuto',
  rpcUrls: {
    default: { http: ['https://rpc-katana-bokuto.t.conduit.xyz'] },
  },
  blockExplorers: {
    default: { name: 'Bokutoscan', url: 'https://bokuto.katanascan.com/' },
  },
  nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 },
};

const MAINNET = createChainEntry({
  wagmi: mainnet,
  icon: ICONS.ethereum,
  networkId: 0,
  isTestnet: false,
  eta: 20,
});

const KATANA = createChainEntry({
  wagmi: katana,
  icon: ICONS.katana,
  networkId: 20,
  isTestnet: false,
  eta: 180,
});

const FORKNET = createChainEntry({
  wagmi: forknetWagmi,
  icon: ICONS.forknet,
  networkId: 22,
  isTestnet: false,
  eta: 180,
});

const SEPOLIA = createChainEntry({
  wagmi: sepolia,
  icon: ICONS.ethereum,
  networkId: 0,
  isTestnet: true,
  eta: 20,
  rpcUrl: 'https://ethereum-sepolia-rpc.publicnode.com',
});

const BOKUTO = createChainEntry({
  wagmi: bokutoWagmi,
  icon: ICONS.bokuto,
  networkId: 37,
  isTestnet: true,
  eta: 180,
});

// Kurtosis L1
const kurtosisL1Wagmi: Chain = {
  id: {{.l1_chain_id}},
  name: 'Kurtosis L1',
  rpcUrls: {
    default: { http: [window.location.origin + '/l1rpc']},
  },
  blockExplorers: {
    default: { name: 'Kurtosis L1 Explorer', url: '' },
  },
  nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 },
}

const kurtosisL1 = createChainEntry({
  wagmi: kurtosisL1Wagmi,
  icon: ICONS.ethereum,
  networkId: 0,
  isTestnet: false,
  eta: 180,
});

// Kurtosis L2 CDK 1
const kurtosisL2_CDK1Wagmi: Chain = {
  id: {{.l2_chain_id}},
  name: 'Kurtosis L2 CDK 1',
  rpcUrls: {
    default: { http: [window.location.origin + '/l2rpc']},
  },
  blockExplorers: {
    default: { name: 'Kurtosis L2 CDK 1 Explorer', url: '' },
  },
  nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 },
};

const kurtosisL2CDK1 = createChainEntry({
  wagmi: kurtosisL2_CDK1Wagmi,
  icon: ICONS.ethereum,
  networkId: {{.l2_network_id}},
  isTestnet: false,
  eta: 180,
});

const CHAIN_REGISTRY: Record<string, ChainEntry> = {
  MAINNET,
  KATANA,
  FORKNET,
  SEPOLIA,
  BOKUTO,
  kurtosisL1,
  kurtosisL2CDK1,
};

export const ALL_WAGMI_CHAINS: readonly [Chain, ...Chain[]] = toNonEmptyChainArray(
  Object.values(CHAIN_REGISTRY).map((entry) => entry.wagmi),
);

export const DEFAULT_APP_MODE: AppMode = 'devnet';

export const APP_MODE_CONFIG: Record<AppMode, AppModeConfig> = {
  mainnet: {
    label: 'Mainnet',
    bridgeAddress: '0x2a3DD3EB832aF982ec71669E178424b10Dca2EDe',
    proofApiUrl: toProofApiUrl('mainnet'),
    defaultFromChainId: MAINNET.app.id,
    defaultToChainId: KATANA.app.id,
    chains: [MAINNET.app, KATANA.app, FORKNET.app],
  },
  testnet: {
    label: 'Testnet',
    bridgeAddress: '0x528e26b25a34a4A5d0dbDa1d57D318153d2ED582',
    proofApiUrl: toProofApiUrl('testnet'),
    defaultFromChainId: SEPOLIA.app.id,
    defaultToChainId: BOKUTO.app.id,
    chains: [SEPOLIA.app, BOKUTO.app],
  },
  devnet: {
    label: 'Devnet',
    bridgeAddress: '{{.l1_bridge_address}}',
    proofApiUrl: toProofApiUrl('devnet'),
    chains: [kurtosisL1.app, kurtosisL2CDK1.app],
  },
};

export const EXTERNAL_LINKS = Object.freeze({
  PRIVACY_POLICY: 'https://polygon.technology/privacy-policy',
  TERMS_OF_USE: 'https://polygon.technology/terms-of-use',
  CONTACT_SUPPORT: 'https://support.polygon.technology/support/home',
} as const);
